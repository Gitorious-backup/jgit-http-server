TODO
- Cache the looked up paths
- set up appropriate logging of lookups